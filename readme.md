# 1、作用
分表工具，用于处理数据库分表；记录当前go语言学习进度

# 2、工具创建和使用
该工具针对不同的分表，需要包装一层调用代码，然后业务在调用代码之上去做处理
使用步骤
1. 创建SubTool结构体对象
2. 创建一个数据库映射对象，多个相同的分表只需要一个映射对象，因为这边不通过xorm的映射方式进行处理
3. sql方法处理

具体使用参考：`demo.go`


# 3、注意事项
## 1、可配性
本工程支持表名规则配置与分表规则配置，可参考`tableIndexFunc` 、`tableNameFunc`
## 2、可移植性
当前代码处理orm对象是xorm/Engine，在一些工程当中可能自己定义相应的Orm对象，这个时候可以把工程拷贝下来进行相应的修改

## 3、数据库映射对象类型
这边的数据库映射对象处理是直接约定为指针类型，代码中处理会直接报错。之所以不做兼容的原因是当前不需要，并且对象类型非结构体处理
可能产生问题。针对不同的结构体对象类型可参考 另一个工程`Go-Tool/util/FieldValueTool`



# 4、待完善
1. 复杂的sql，比如join的这种操作处理(当前想法是提供一个接口，使用者通过传入一个sql，程序进行相应的字段替换，组装成分表数量对应条数的sql进行执行)
2. 暂时不支持一组非主键字段的IN 操作查询
3. 暂时不支持根据多个字段进行查询的操作

# 5、更新日志
2020/4/24 ：创建工程、readme文档、示例文档

2020/7/14 ：整理整合优化代码

2020/7/15 : 工程重命名、优化xorm查询engine为session(可一次性提交增删改sql)、新增根据一组key进行删除方法


# 6、注意问题
在使用的时候要记得引入对应的数据库驱动包，比如我这边的实例是连接mysql，所以引入的是 _ "github.com/go-sql-driver/mysql"

当前的分表采用session的方式，并提供对应的commit方法，使用在操作过程中可以使用当前框架的方法进行Commit或者直接使用session的Commit方法，结果是一样的


# 7、mod vendor模式加载包
通过go mod的方式加载的github上面的包会有报红的问题，但是包本身是可以运行的，这样就是会有一个问题，如果你想要点击去看方法的内容，没办法做到

查阅了网上提供的处理方式，通过设置GOPATH 和Go Modules(vgo)可以解决相应的问题，但是我在这样处理之后依然会出现报红的问题

后面通过使用vendor包的方式来处理，就避免了报红的问题

处理步骤如下 ：
- 通过 go get github.com/kardianos/govendor 命令下载govendor命令
- 通过 go mod vendor 切换到vendor管理


# 8、后续跟新
sql增删改查的情况很多，相应的加上分表，需要处理的具体场景也不一样，这部分的东西只能说后面遇到之后再进行补充，没办法一下子全部弄上去